| distributed init (rank 0): env://
Namespace(data_path='/media/data/ILSVRC2012', model='resnet50', device='cuda', batch_size=32, epochs=90, workers=16, opt='sgd', lr=0.1, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=10, output_dir='.', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=True, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=1, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights=None, backend='pil', use_v2=False, rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.3295037746429443
Loading validation data
Creating data loaders
Creating model
| module                                           | #parameters or shape   | #flops     |
|:-------------------------------------------------|:-----------------------|:-----------|
| module                                           | 76.02M                 | 6.579G     |
|  conv1                                           |  9.408K                |  0.118G    |
|   conv1.weight                                   |   (64, 3, 7, 7)        |            |
|  bn1                                             |  0.128K                |  1.606M    |
|   bn1.weight                                     |   (64,)                |            |
|   bn1.bias                                       |   (64,)                |            |
|  layer1                                          |  0.216M                |  0.677G    |
|   layer1.0                                       |   75.008K              |   0.235G   |
|    layer1.0.conv1                                |    4.096K              |    12.845M |
|    layer1.0.bn1                                  |    0.128K              |    0.401M  |
|    layer1.0.conv2                                |    36.864K             |    0.116G  |
|    layer1.0.bn2                                  |    0.128K              |    0.401M  |
|    layer1.0.conv3                                |    16.384K             |    51.38M  |
|    layer1.0.bn3                                  |    0.512K              |    1.606M  |
|    layer1.0.downsample                           |    16.896K             |    52.986M |
|   layer1.1                                       |   70.4K                |   0.221G   |
|    layer1.1.conv1                                |    16.384K             |    51.38M  |
|    layer1.1.bn1                                  |    0.128K              |    0.401M  |
|    layer1.1.conv2                                |    36.864K             |    0.116G  |
|    layer1.1.bn2                                  |    0.128K              |    0.401M  |
|    layer1.1.conv3                                |    16.384K             |    51.38M  |
|    layer1.1.bn3                                  |    0.512K              |    1.606M  |
|   layer1.2                                       |   70.4K                |   0.221G   |
|    layer1.2.conv1                                |    16.384K             |    51.38M  |
|    layer1.2.bn1                                  |    0.128K              |    0.401M  |
|    layer1.2.conv2                                |    36.864K             |    0.116G  |
|    layer1.2.bn2                                  |    0.128K              |    0.401M  |
|    layer1.2.conv3                                |    16.384K             |    51.38M  |
|    layer1.2.bn3                                  |    0.512K              |    1.606M  |
|  layer2                                          |  1.22M                 |  1.034G    |
|   layer2.0                                       |   0.379M               |   0.375G   |
|    layer2.0.conv1                                |    32.768K             |    0.103G  |
|    layer2.0.bn1                                  |    0.256K              |    0.803M  |
|    layer2.0.conv2                                |    0.147M              |    0.116G  |
|    layer2.0.bn2                                  |    0.256K              |    0.201M  |
|    layer2.0.conv3                                |    65.536K             |    51.38M  |
|    layer2.0.bn3                                  |    1.024K              |    0.803M  |
|    layer2.0.downsample                           |    0.132M              |    0.104G  |
|   layer2.1                                       |   0.28M                |   0.22G    |
|    layer2.1.conv1                                |    65.536K             |    51.38M  |
|    layer2.1.bn1                                  |    0.256K              |    0.201M  |
|    layer2.1.conv2                                |    0.147M              |    0.116G  |
|    layer2.1.bn2                                  |    0.256K              |    0.201M  |
|    layer2.1.conv3                                |    65.536K             |    51.38M  |
|    layer2.1.bn3                                  |    1.024K              |    0.803M  |
|   layer2.2                                       |   0.28M                |   0.22G    |
|    layer2.2.conv1                                |    65.536K             |    51.38M  |
|    layer2.2.bn1                                  |    0.256K              |    0.201M  |
|    layer2.2.conv2                                |    0.147M              |    0.116G  |
|    layer2.2.bn2                                  |    0.256K              |    0.201M  |
|    layer2.2.conv3                                |    65.536K             |    51.38M  |
|    layer2.2.bn3                                  |    1.024K              |    0.803M  |
|   layer2.3                                       |   0.28M                |   0.22G    |
|    layer2.3.conv1                                |    65.536K             |    51.38M  |
|    layer2.3.bn1                                  |    0.256K              |    0.201M  |
|    layer2.3.conv2                                |    0.147M              |    0.116G  |
|    layer2.3.bn2                                  |    0.256K              |    0.201M  |
|    layer2.3.conv3                                |    65.536K             |    51.38M  |
|    layer2.3.bn3                                  |    1.024K              |    0.803M  |
|  layer3                                          |  7.098M                |  1.469G    |
|   layer3.0                                       |   1.512M               |   0.374G   |
|    layer3.0.conv1                                |    0.131M              |    0.103G  |
|    layer3.0.bn1                                  |    0.512K              |    0.401M  |
|    layer3.0.conv2                                |    0.59M               |    0.116G  |
|    layer3.0.bn2                                  |    0.512K              |    0.1M    |
|    layer3.0.conv3                                |    0.262M              |    51.38M  |
|    layer3.0.bn3                                  |    2.048K              |    0.401M  |
|    layer3.0.downsample                           |    0.526M              |    0.103G  |
|   layer3.1                                       |   1.117M               |   0.219G   |
|    layer3.1.conv1                                |    0.262M              |    51.38M  |
|    layer3.1.bn1                                  |    0.512K              |    0.1M    |
|    layer3.1.conv2                                |    0.59M               |    0.116G  |
|    layer3.1.bn2                                  |    0.512K              |    0.1M    |
|    layer3.1.conv3                                |    0.262M              |    51.38M  |
|    layer3.1.bn3                                  |    2.048K              |    0.401M  |
|   layer3.2                                       |   1.117M               |   0.219G   |
|    layer3.2.conv1                                |    0.262M              |    51.38M  |
|    layer3.2.bn1                                  |    0.512K              |    0.1M    |
|    layer3.2.conv2                                |    0.59M               |    0.116G  |
|    layer3.2.bn2                                  |    0.512K              |    0.1M    |
|    layer3.2.conv3                                |    0.262M              |    51.38M  |
|    layer3.2.bn3                                  |    2.048K              |    0.401M  |
|   layer3.3                                       |   1.117M               |   0.219G   |
|    layer3.3.conv1                                |    0.262M              |    51.38M  |
|    layer3.3.bn1                                  |    0.512K              |    0.1M    |
|    layer3.3.conv2                                |    0.59M               |    0.116G  |
|    layer3.3.bn2                                  |    0.512K              |    0.1M    |
|    layer3.3.conv3                                |    0.262M              |    51.38M  |
|    layer3.3.bn3                                  |    2.048K              |    0.401M  |
|   layer3.4                                       |   1.117M               |   0.219G   |
|    layer3.4.conv1                                |    0.262M              |    51.38M  |
|    layer3.4.bn1                                  |    0.512K              |    0.1M    |
|    layer3.4.conv2                                |    0.59M               |    0.116G  |
|    layer3.4.bn2                                  |    0.512K              |    0.1M    |
|    layer3.4.conv3                                |    0.262M              |    51.38M  |
|    layer3.4.bn3                                  |    2.048K              |    0.401M  |
|   layer3.5                                       |   1.117M               |   0.219G   |
|    layer3.5.conv1                                |    0.262M              |    51.38M  |
|    layer3.5.bn1                                  |    0.512K              |    0.1M    |
|    layer3.5.conv2                                |    0.59M               |    0.116G  |
|    layer3.5.bn2                                  |    0.512K              |    0.1M    |
|    layer3.5.conv3                                |    0.262M              |    51.38M  |
|    layer3.5.bn3                                  |    2.048K              |    0.401M  |
|  layer4                                          |  14.965M               |  0.81G     |
|   layer4.0                                       |   6.04M                |   0.373G   |
|    layer4.0.conv1                                |    0.524M              |    0.103G  |
|    layer4.0.bn1                                  |    1.024K              |    0.201M  |
|    layer4.0.conv2                                |    2.359M              |    0.116G  |
|    layer4.0.bn2                                  |    1.024K              |    50.176K |
|    layer4.0.conv3                                |    1.049M              |    51.38M  |
|    layer4.0.bn3                                  |    4.096K              |    0.201M  |
|    layer4.0.downsample                           |    2.101M              |    0.103G  |
|   layer4.1                                       |   4.463M               |   0.219G   |
|    layer4.1.conv1                                |    1.049M              |    51.38M  |
|    layer4.1.bn1                                  |    1.024K              |    50.176K |
|    layer4.1.conv2                                |    2.359M              |    0.116G  |
|    layer4.1.bn2                                  |    1.024K              |    50.176K |
|    layer4.1.conv3                                |    1.049M              |    51.38M  |
|    layer4.1.bn3                                  |    4.096K              |    0.201M  |
|   layer4.2                                       |   4.463M               |   0.219G   |
|    layer4.2.conv1                                |    1.049M              |    51.38M  |
|    layer4.2.bn1                                  |    1.024K              |    50.176K |
|    layer4.2.conv2                                |    2.359M              |    0.116G  |
|    layer4.2.bn2                                  |    1.024K              |    50.176K |
|    layer4.2.conv3                                |    1.049M              |    51.38M  |
|    layer4.2.bn3                                  |    4.096K              |    0.201M  |
|  encoder                                         |  50.463M               |  2.468G    |
|   encoder.pos_embedding                          |   (1, 49, 2048)        |            |
|   encoder.layers.encoder_layer_0                 |   50.358M              |   2.467G   |
|    encoder.layers.encoder_layer_0.ln_1           |    4.096K              |    0.502M  |
|    encoder.layers.encoder_layer_0.self_attention |    16.785M             |    0.822G  |
|    encoder.layers.encoder_layer_0.ln_2           |    4.096K              |    0.502M  |
|    encoder.layers.encoder_layer_0.mlp            |    33.565M             |    1.644G  |
|   encoder.ln                                     |   4.096K               |   0.502M   |
|    encoder.ln.weight                             |    (2048,)             |            |
|    encoder.ln.bias                               |    (2048,)             |            |
|  fc                                              |  2.049M                |  2.048M    |
|   fc.weight                                      |   (1000, 2048)         |            |
|   fc.bias                                        |   (1000,)              |            |
|  avgpool                                         |                        |  0.1M      |
